<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/fontawesome/css/brands.css" rel="stylesheet">
<link href="/fontawesome/css/solid.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  <title>SpringMVC学习笔记 | Kizureina&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="SpringMVC是隶属于Spring框架的一部分，主要是用来进行Web开发，是对Servlet进行了封装。 SpringMVC是处于Web层的框架，所以其主要作用就是用来接收前端发过来的请求和数据，然后经过处理之后将处理结果响应给前端，所以如何处理请求和响应是SpringMVC中非常重要的一块内容。 REST是一种软件架构风格，可以降低开发的复杂性，提高系统的可伸缩性，后期的应用也是非常广泛。">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringMVC学习笔记">
<meta property="og:url" content="https://kizureina.github.io/2023/03/12/Note-of-SpringMVC-learning/index.html">
<meta property="og:site_name" content="Kizureina&#39;s Blog">
<meta property="og:description" content="SpringMVC是隶属于Spring框架的一部分，主要是用来进行Web开发，是对Servlet进行了封装。 SpringMVC是处于Web层的框架，所以其主要作用就是用来接收前端发过来的请求和数据，然后经过处理之后将处理结果响应给前端，所以如何处理请求和响应是SpringMVC中非常重要的一块内容。 REST是一种软件架构风格，可以降低开发的复杂性，提高系统的可伸缩性，后期的应用也是非常广泛。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic.imgdb.cn/item/631969df16f2c2beb1dfa3f2.jpg">
<meta property="og:image" content="https://s1.ax1x.com/2023/03/19/ppYIR0A.png">
<meta property="og:image" content="https://pic.imgdb.cn/item/631addfe16f2c2beb1732627.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/631b004216f2c2beb19d8a0a.jpg">
<meta property="article:published_time" content="2023-03-12T10:00:45.000Z">
<meta property="article:modified_time" content="2023-07-13T07:08:55.326Z">
<meta property="article:author" content="Kizurena">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic.imgdb.cn/item/631969df16f2c2beb1dfa3f2.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Kizureina's Blog" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/assets/banner.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="shadow   ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>Kizureina's Blog </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="material-symbols-rounded light-mode-icon">wb_sunny</span>
      <span class="material-symbols-rounded dark-mode-icon">dark_mode</span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS 订阅">
        <span class="material-symbols-rounded rss">rss_feed</span>
      </a>
    
    <a id="nav-search-btn" class="nav-icon" title="搜索" style="display: none;">
      <span class="material-symbols-rounded">search</span>
    </a>
    <div id="nav-menu-btn" class="nav-icon">
      <span class="material-symbols-rounded">menu</span>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS 订阅">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/assets/avatar.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Kizureina </div>
      <div class="dot"></div>
      <div class="subtitle">I know nothing except the fact of my ignorance. </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/Kizureina" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">分类</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/WebSec/">
                WebSec
                <div class="category-count">6</div>
            </a>
        
            <a class="category-link" href="/categories/Web/">
                Web
                <div class="category-count">14</div>
            </a>
        
            <a class="category-link" href="/categories/EE/">
                EE
                <div class="category-count">2</div>
            </a>
        
            <a class="category-link" href="/categories/Reverse/">
                Reverse
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/MISC/">
                MISC
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/ACG/">
                ACG
                <div class="category-count">3</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">标签</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Comic/" rel="tag">Comic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Galgame/" rel="tag">Galgame</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/RCE/" rel="tag">RCE</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Reverse-shell/" rel="tag">Reverse shell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/java-RCE/" rel="tag">java RCE</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/" rel="tag">嵌入式</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E7%A1%AC%E4%BB%B6/" rel="tag">硬件</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">归档</h3>
      
      
        <a class="archive-link" href="/archives/2023/07 ">
          七月 2023 
          <div class="archive-count">5 </div>
        </a>
      
        <a class="archive-link" href="/archives/2023/06 ">
          六月 2023 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2023/03 ">
          三月 2023 
          <div class="archive-count">2 </div>
        </a>
      
        <a class="archive-link" href="/archives/2023/02 ">
          二月 2023 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2023/01 ">
          一月 2023 
          <div class="archive-count">4 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/12 ">
          十二月 2022 
          <div class="archive-count">3 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/11 ">
          十一月 2022 
          <div class="archive-count">2 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/09 ">
          九月 2022 
          <div class="archive-count">2 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/06 ">
          六月 2022 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/04 ">
          四月 2022 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/03 ">
          三月 2022 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/02 ">
          二月 2022 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2022/01 ">
          一月 2022 
          <div class="archive-count">3 </div>
        </a>
      
        <a class="archive-link" href="/archives/2021/12 ">
          十二月 2021 
          <div class="archive-count">1 </div>
        </a>
      
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">最新文章</h3>
      <ul>
        
          <li>
            <a href="/2023/07/31/Record-of-Web-Sec-s-practice/">安恒大运会安服实习总结</a>
          </li>
        
          <li>
            <a href="/2023/07/25/BLE-KeyBoard-based-STM32/">手搓蓝牙机械键盘——基于ESP32、STM32、CH573</a>
          </li>
        
          <li>
            <a href="/2023/07/24/Thinking-of-Sakura-no-Uta/">《樱之诗》随想</a>
          </li>
        
          <li>
            <a href="/2023/07/13/Kit-of-using-WRF-module-for-prediction/">气象运算模式WRF使用教程</a>
          </li>
        
          <li>
            <a href="/2023/07/07/The-exp-of-Redis-unauthorized/">Redis未授权访问原理及利用</a>
          </li>
        
      </ul>
    </div>
  </div>

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       

<article id="post-Note-of-SpringMVC-learning" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        SpringMVC学习笔记
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2023-03-12T10:00:45.000Z" itemprop="datePublished">2023-03-12</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/Web/">Web</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            8k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p>SpringMVC是隶属于Spring框架的一部分，主要是用来进行Web开发，是<strong>对Servlet进行了封装</strong>。</p>
<p>SpringMVC是处于Web层的框架，所以其主要作用就是用来<strong>接收前端发过来的请求和数据</strong>，然后经过处理之后将处理结果响应给前端，所以如何处理请求和响应是SpringMVC中非常重要的一块内容。</p>
<p>REST是一种软件架构风格，可以<strong>降低开发的复杂性</strong>，提高系统的可伸缩性，后期的应用也是非常广泛。</p>
<p>对于SpringMVC的学习，<code>最终要达成的目标：</code></p>
<ol>
<li>掌握基于SpringMVC获取请求参数和响应JSON数据操作</li>
<li>熟练应用基于REST风格的请求路径设置与参数传递</li>
<li>能根据实际业务建立前后端开发通信协议，并进行实现</li>
<li>基于SSM整合技术开发任意业务模块功能</li>
</ol>
<h2 id="SpringMCV总览"><a href="#SpringMCV总览" class="headerlink" title="SpringMCV总览"></a>SpringMCV总览</h2><p>目前Java Web的开发方式是如下：</p>
<p>将后端服务器Servlet拆分成三层，分别是Web，Service和DAO。</p>
<ul>
<li><p><code>web</code>层主要由<code>servlet</code>来处理，负责页面请求和数据的收集以及响应结果给前端</p>
</li>
<li><p><code>service</code>层主要负责<strong>业务逻辑</strong>的处理</p>
</li>
<li><p><code>dao</code>层主要负责<strong>数据</strong>的增删改查操作</p>
</li>
<li><p>但<code>servlet</code>处理请求和数据时，存在一个问题：一个<code>servlet</code>只能处理一个请求</p>
</li>
</ul>
<p>针对<strong>Web层进行优化</strong>，采用MVC设计模式，将其设计为Controller，View和Model，即MVC的设计模式。</p>
<ul>
<li><code>controller</code>负责请求和数据的接收，接收后将其转发给<code>service</code>进行业务处理</li>
<li><code>service</code>根据需要会调用<code>dao</code>对数据进行增删改查</li>
<li><code>dao</code>把数据处理完后，将结果交给<code>service</code>，<code>service</code>再交给<code>controller</code></li>
<li><code>controller</code>根据需求组装成<code>Model</code>和<code>View</code>，<code>Model</code>和<code>View</code>组合起来生成页面，转发给前端浏览器</li>
<li>这样做的好处就是<code>controller</code>可以处理多个请求，并对请求进行分发，执行不同的业务操作</li>
</ul>
<p>但随着互联网的发展，上面的模式因为是<strong>同步</strong>调用，性能太差跟不上需求，所以<strong>异步</strong>调用走到了前端，是现在比较流行的一种处理方式。</p>
<p><img src="https://pic.imgdb.cn/item/631969df16f2c2beb1dfa3f2.jpg" alt="img"></p>
<ul>
<li>因为是异步调用，所以后端不需要返回View视图，将其去除</li>
<li>前端如果通过异步调用的方式进行交互，后端就需要<strong>将返回的数据转换成JSON格式</strong>进行返回</li>
<li>SpringMVC主要负责的就是<ul>
<li>controller如何接收请求和数据</li>
<li>如何将请求和数据转发给业务层</li>
<li>如何将响应数据转换成JSON返回到前端</li>
</ul>
</li>
<li>SpringMVC是一种基于Java实现MVC模型的轻量级Web框架<ul>
<li>优点<ul>
<li>使用简单、开发快捷（相比较于Servlet）</li>
<li>灵活性强</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="SpringMCV入门"><a href="#SpringMCV入门" class="headerlink" title="SpringMCV入门"></a>SpringMCV入门</h2><p>因为SpringMVC是一个Web框架，将来是要<strong>替换Servlet</strong>，所以先来回顾下以前Servlet是如何进行开发的?</p>
<ol>
<li>创建web工程(Maven结构)</li>
<li>设置tomcat服务器，加载web工程(tomcat插件)</li>
<li>导入坐标(Servlet)</li>
<li>定义处理请求的功能类(UserServlet)</li>
<li>设置请求映射(配置映射关系)</li>
</ol>
<p>SpringMVC的制作过程和上述流程几乎是一致的，具体的实现流程是什么?</p>
<ol>
<li>创建web工程(Maven结构)</li>
<li>设置tomcat服务器，加载web工程(tomcat插件)</li>
<li>导入坐标(SpringMVC+Servlet)</li>
<li>定义处理请求的功能类(UserController)</li>
<li>设置请求映射(配置映射关系)</li>
<li>将SpringMVC设定加载到Tomcat容器中</li>
</ol>
<p>另外，使用Maven骨架的webapp搭建JavaWeb环境配置tomcat会更方便，可直接识别为Web工件。</p>
<p>搭建好Web环境导入SpringMVC坐标后，创建Controller类(即javaWeb中的Servlet)：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义Controller，使用@Controller定义Bean让Spring对该类进行托管</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="comment">//设置当前访问路径，使用@RequestMapping</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/save&quot;)</span></span><br><span class="line">    <span class="comment">//设置当前对象的返回值类型</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;user save ...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;SpringMVC&#x27;&#125;&quot;</span>;</span><br><span class="line">        <span class="comment">//返回值为JSON格式的字符串</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>始化SpringMVC环境（同Spring环境），设定SpringMVC加载对应的Bean：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建SpringMVC的配置文件，加载controller对应的bean</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.hit.controller&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>初始化Servlet容器(类似Spring入门中的App类)，加载SpringMVC环境，设置SpringMVC对请求进行的处理：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hit.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.WebApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.support.AnnotationConfigWebApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.support.AbstractDispatcherServletInitializer;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个servlet容器的配置类，在里面加载Spring的配置，继承AbstractDispatcherServletInitializer并重写其方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContainerInitConfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractDispatcherServletInitializer</span> &#123;</span><br><span class="line">    <span class="comment">//加载SpringMvc容器配置</span></span><br><span class="line">    <span class="keyword">protected</span> WebApplicationContext <span class="title function_">createServletApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigWebApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigWebApplicationContext</span>();</span><br><span class="line">        context.register(SpringMvcConfig.class);</span><br><span class="line">        <span class="keyword">return</span> context;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//设置哪些请求归SpringMvc处理</span></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="comment">//相当于JavaWeb中filter所有请求都交由SpringMVC处理</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//加载Spring容器配置</span></span><br><span class="line">    <span class="keyword">protected</span> WebApplicationContext <span class="title function_">createRootApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>此时项目结构为：</p>
<p><img src="https://s1.ax1x.com/2023/03/19/ppYIR0A.png" alt="Snipaste 2023 03 19 17 52 39"></p>
<p>最后访问localhost&#x2F;save即可，另外也可在IDEA内进行接口测试。页面上成功出现<code>&#123;&#39;info&#39;:&#39;springmvc&#39;&#125;</code>，至此我们的SpringMVC入门案例就完成了。</p>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul>
<li>SpringMVC是基于Spring的，在pom.xml只导入了<code>spring-webmvc</code>jar包的原因是它会自动依赖spring相关坐标</li>
<li><code>AbstractDispatcherServletInitializer</code>类是SpringMVC提供的快速初始化Web3.0容器的抽象类</li>
<li><strong>AbstractDispatcherServletInitializer</strong>提供了三个接口方法供用户实现<ul>
<li><code>createServletApplicationContext</code>方法，创建Servlet容器时，加载SpringMVC对应的bean并放入<code>WebApplicationContext</code>对象范围中，而<code>WebApplicationContext</code>的作用范围为<code>ServletContext</code>范围，即整个web容器范围。</li>
<li><code>getServletMappings</code>方法，设定SpringMVC对应的请求映射路径，即SpringMVC<strong>拦截哪些请求</strong>。</li>
<li><code>createRootApplicationContext</code>方法，如果创建Servlet容器时需要加载非SpringMVC对应的bean，使用当前方法进行，使用方式和<code>createServletApplicationContext</code>相同。</li>
</ul>
</li>
<li><code>createServletApplicationContext</code>用来加载<strong>SpringMVC环境</strong></li>
<li><code>createRootApplicationContext</code>用来加载<strong>Spring环境</strong></li>
</ul>
<h3 id="SpringMVC工作流程解析"><a href="#SpringMVC工作流程解析" class="headerlink" title="SpringMVC工作流程解析"></a>SpringMVC工作流程解析</h3><h4 id="启动服务器流程"><a href="#启动服务器流程" class="headerlink" title="启动服务器流程"></a>启动服务器流程</h4><ol>
<li><p>服务器启动，执行<strong>ServletContainerInitConfig</strong>类，初始化web容器</p>
<ul>
<li><p>功能类似于web.xml</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContainerInitConfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractDispatcherServletInitializer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> WebApplicationContext <span class="title function_">createServletApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigWebApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigWebApplicationContext</span>();</span><br><span class="line">        context.register(SpringMvcConfig.class);</span><br><span class="line">        <span class="keyword">return</span> context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> WebApplicationContext <span class="title function_">createRootApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>执行**createServletApplicationContext()**方法，创建了WebApplicationContext对象</p>
<ul>
<li><p>该方法加载SpringMVC的配置类SpringMvcConfig来初始化SpringMVC的容器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> WebApplicationContext <span class="title function_">createServletApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">AnnotationConfigWebApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigWebApplicationContext</span>();</span><br><span class="line">    context.register(SpringMvcConfig.class);</span><br><span class="line">    <span class="keyword">return</span> context;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>加载<strong>SpringMvcConfig配置类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.hit.controller&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行<code>@ComponentScan</code>加载对应的bean</p>
<ul>
<li>扫描指定包及其子包下所有类上的注解，如Controller类上的<code>@Controller</code>注解</li>
</ul>
</li>
<li><p>加载<code>UserController</code>类，每个<code>@RequestMapping</code>的名称（即url请求路径）对应一个具体的方法</p>
<ul>
<li><p>此时就建立了&#x2F;save和save()方法的对应关系</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/save&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;user save ...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;SpringMVC&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>执行<code>getServletMappings()</code>方法，设定SpringMVC拦截请求的路径规则<code>/</code>, 代表所拦截请求的路径规则，只有被拦截后才能交给SpringMVC来处理请求</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="单次请求流程"><a href="#单次请求流程" class="headerlink" title="单次请求流程"></a>单次请求流程</h4><ol>
<li>发送请求<code>http://localhost/save</code></li>
<li>web容器发现该请求<strong>满足SpringMVC拦截规则</strong>，将请求交给SpringMVC处理</li>
<li>解析请求路径&#x2F;save</li>
<li>由<code>/save</code>匹配执行对应的方法<code>save()</code>上面的第5步已经将请求路径和方法建立了对应关系，通过<code>/save</code>就能找到对应的<code>save()</code>方法</li>
<li>执行<code>save()</code></li>
<li>检测到有<code>@ResponseBody</code>直接将<code>save()</code>方法的返回值作为响应体返回给请求方</li>
</ol>
<h3 id="Bean加载控制"><a href="#Bean加载控制" class="headerlink" title="Bean加载控制"></a>Bean加载控制</h3><h4 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h4><p>目前项目中有config, controller, service, dao四个包：</p>
<ul>
<li><code>config</code>目录存入的是配置类，写过的配置类有:<ul>
<li>ServletContainersInitConfig</li>
<li>SpringConfig</li>
<li>SpringMvcConfig</li>
<li>JdbcConfig</li>
<li>MybatisConfig</li>
</ul>
</li>
<li><code>controller</code>目录存放的是<code>SpringMVC</code>的<code>controller</code>类</li>
<li><code>service</code>目录存放的是<code>service</code>接口和实现类</li>
<li><code>dao</code>目录存放的是<code>dao/Mapper</code>接口</li>
</ul>
<p>除config外其他所有类都需要被容器管理为bean对象，那么具体bean对象是由Spring加载还是SpringMVC加载？</p>
<ul>
<li><code>SpringMVC</code>控制的bean<ul>
<li>表现层bean,也就是<code>controller</code>包下的类(即Servlet功能的类)</li>
</ul>
</li>
<li><code>Spring</code>控制的bean<ul>
<li>业务bean(<code>Service</code>)</li>
<li>功能bean(<code>DataSource</code>,<code>SqlSessionFactoryBean</code>,<code>MapperScannerConfigurer</code>等)</li>
</ul>
</li>
</ul>
<p>分析清楚谁该管哪些bean以后，接下来要解决的问题是如何让<code>Spring</code>和<code>SpringMVC</code>分开加载各自的内容。</p>
<h4 id="解决思路"><a href="#解决思路" class="headerlink" title="解决思路"></a>解决思路</h4><p>对于上面的问题，解决方案也比较简单</p>
<ul>
<li>加载Spring控制的bean的时候，<code>排除掉</code><strong>SpringMVC控制的bean</strong>。</li>
</ul>
<p>那么具体该如何实现呢？</p>
<ul>
<li>方式一：Spring加载的bean设定扫描范围<code>com.hit</code>，排除掉<code>controller</code>包内的bean</li>
<li>方式二：Spring加载的bean设定扫描范围为精确扫描，具体到<code>service</code>包，<code>dao</code>包等</li>
<li>方式三：不区分Spring与SpringMVC的环境，加载到同一个环境中(<code>了解即可</code>)</li>
</ul>
<p>具体解决：</p>
<ul>
<li><p>解决方案一：修改Spring配置类，设定扫描范围为精准范围</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.hit.dao&quot;,&quot;com.hit.service&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再次运行App运行类，报错<code>NoSuchBeanDefinitionException</code>，说明Spring配置类没有扫描到UserController，目的达成.</p>
</li>
<li><p>解决方案二：修改Spring配置类，设定扫描范围为com.blog，排除掉controller包中的bean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(value = &quot;com.hit&quot;,</span></span><br><span class="line"><span class="meta">    excludeFilters = @ComponentScan.Filter(</span></span><br><span class="line"><span class="meta">            type = FilterType.ANNOTATION,</span></span><br><span class="line"><span class="meta">            classes = Controller.class</span></span><br><span class="line"><span class="meta">    ))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>excludeFilters属性：设置扫描加载bean时，排除的过滤规则</p>
</li>
<li><p>type属性：设置排除规则，当前使用按照bean定义时的注解类型进行排除</p>
<ul>
<li>ANNOTATION：按照注解排除</li>
<li>ASSIGNABLE_TYPE:按照指定的类型过滤</li>
<li>ASPECTJ:按照Aspectj表达式排除，基本上不会用</li>
<li>REGEX:按照正则表达式排除</li>
<li>CUSTOM:按照自定义规则排除</li>
</ul>
</li>
<li><p>classes属性：设置排除的具体注解类，当前设置排除<code>@Controller</code>定义的bean</p>
</li>
</ul>
<p>运行程序之前，我们还需要把<code>SpringMvcConfig</code>配置类上的<code>@ComponentScan</code>注解注释掉，否则不会报错，将正常输出</p>
<ul>
<li>出现问题的原因是<ul>
<li>Spring配置类扫描的包是<code>com.hit</code></li>
<li>SpringMVC的配置类，<code>SpringMvcConfig</code>上有一个<code>@Configuration</code>注解，也会被Spring扫描到</li>
<li>SpringMvcConfig上又有一个<code>@ComponentScan</code>，把controller类又给扫描进来了</li>
<li>所以如果不把<code>@ComponentScan</code>注释掉，Spring配置类将Controller排除，但是因为扫描到SpringMVC的配置类，又将其加载回来，演示的效果就出不来</li>
<li>解决方案，也简单，把SpringMVC的配置类移出Spring配置类的扫描范围即可。</li>
</ul>
</li>
</ul>
<p>运行程序，同样报错<code>NoSuchBeanDefinitionException</code>，目的达成</p>
<p>最后一个问题，有了Spring的配置类，要想在tomcat服务器启动将其加载，我们需要修改<code>ServletContainersInitConfig</code>类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContainerInitConfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractDispatcherServletInitializer</span> &#123;</span><br><span class="line">    <span class="comment">//加载SpringMvc配置</span></span><br><span class="line">    <span class="keyword">protected</span> WebApplicationContext <span class="title function_">createServletApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigWebApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigWebApplicationContext</span>();</span><br><span class="line">        context.register(SpringMvcConfig.class);</span><br><span class="line">        <span class="keyword">return</span> context;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//设置哪些请求归SpringMvc处理</span></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//加载Spring容器配置</span></span><br><span class="line">    <span class="keyword">protected</span> WebApplicationContext <span class="title function_">createRootApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigWebApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigWebApplicationContext</span>();</span><br><span class="line">        context.register(SpringConfig.class);</span><br><span class="line">        <span class="keyword">return</span> context;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>对于上面的<code>ServletContainerInitConfig</code>配置类，Spring还提供了一种更简单的配置方式，可以不用再去创建<code>AnnotationConfigWebApplicationContext</code>对象，不用手动<code>register</code>对应的配置类<br>我们改用继承它的子类<code>AbstractAnnotationConfigDispatcherServletInitializer</code>，然后重写三个方法即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContainerInitConfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationConfigDispatcherServletInitializer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringMvcConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SpringMVC请求与响应"><a href="#SpringMVC请求与响应" class="headerlink" title="SpringMVC请求与响应"></a>SpringMVC请求与响应</h2><p>SpringMVC是web层的框架，主要的作用是<strong>接收请求、接收数据、响应结果</strong>。<br>所以这部分是学习SpringMVC的重点内容，这里主要会讲解四部分内容:</p>
<ul>
<li>请求映射路径</li>
<li>请求参数</li>
<li>日期类型参数传递</li>
<li>响应JSON数据</li>
</ul>
<h3 id="请求映射路径"><a href="#请求映射路径" class="headerlink" title="请求映射路径"></a>请求映射路径</h3><p>如果需要由多个controller，但不能重复，可在controller前加<strong>RequestMapping</strong>注解：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/save&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;user save ..&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user save&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/delete&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;user delete ..&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user delete&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="请求参数"><a href="#请求参数" class="headerlink" title="请求参数"></a>请求参数</h3><h4 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h4><p>按上面的方式写需要前端请求参数名与后端的save函数形参相同，否则需要用倒@RequestParam注解：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/commonParam&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">commonParam</span><span class="params">(<span class="meta">@RequestParam(&quot;username&quot;)</span> String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;普通参数传递name --&gt; &quot;</span> + name);</span><br><span class="line">        System.out.println(<span class="string">&quot;普通参数传递age --&gt; &quot;</span> + age);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;commonParam&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="pojo类型"><a href="#pojo类型" class="headerlink" title="pojo类型"></a>pojo类型</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//POJO参数：请求参数与形参对象中的属性对应即可完成参数传递</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/pojoParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">pojoParam</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;POJO参数传递user --&gt; &quot;</span> + user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;pojo param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当请求为<code>localhost/user/pojoParam?name=Helsing&amp;age=1024</code></p>
<p>控制台输出：<code>POJO参数传递user —&gt; User&#123;name=’Helsing’, age=1024&#125;</code></p>
<ul>
<li>注意:<ul>
<li>POJO参数接收，前端GET和POST发送请求数据的方式不变。</li>
<li>可使用嵌套Pojo参数</li>
<li>请求<strong>参数key的名称要和POJO中属性的名称一致</strong>，否则无法封装。</li>
</ul>
</li>
</ul>
<h4 id="数组类型"><a href="#数组类型" class="headerlink" title="数组类型"></a>数组类型</h4><ul>
<li><p>数组参数：<strong>请求参数名与形参对象属性名相同且请求参数为多个</strong>，定义数组类型即可接收参数</p>
</li>
<li><p>发送请求和参数：<code>localhost/user/arrayParam?hobbies=sing&amp;hobbies=jump&amp;hobbies=rap&amp;hobbies=basketball</code></p>
</li>
<li><p>后台接收参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/arrayParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">arrayParam</span><span class="params">(String[] hobbies)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;数组参数传递user --&gt; &quot;</span> + Arrays.toString(hobbies));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;array param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>控制台输出如下</p>
<blockquote>
<p>数组参数传递user —&gt; [sing, jump, rap, basketball]</p>
</blockquote>
</li>
</ul>
<h4 id="集合类型"><a href="#集合类型" class="headerlink" title="集合类型"></a>集合类型</h4><p>与数组类型，也可接收集合类型的参数：</p>
<ul>
<li><p>发送请求和参数：<code>localhost/user/listParam?hobbies=sing&amp;hobbies=jump&amp;hobbies=rap&amp;hobbies=basketball</code></p>
</li>
<li><p>后台接收参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/listParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">listParam</span><span class="params">(List hobbies)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;集合参数传递user --&gt; &quot;</span> + hobbies);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;list param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行程序，报错<code>java.lang.IllegalArgumentException: Cannot generate variable name for non-typed Collection parameter type</code></p>
<ul>
<li>错误原因：SpringMVC<strong>将List看做是一个POJO对象来处理</strong>，将其创建一个对象并准备把前端的数据封装到对象中，但是List是一个接口无法创建对象，所以报错。</li>
</ul>
</li>
<li><p>解决方案是：使用<code>@RequestParam</code>注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/listParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">listParam</span><span class="params">(<span class="meta">@RequestParam</span> List hobbies)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;集合参数传递user --&gt; &quot;</span> + hobbies);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;list param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>控制台输出如下</p>
<blockquote>
<p>集合参数传递user —&gt; [sing, jump, rap, basketball]</p>
</blockquote>
</li>
</ul>
<h4 id="JSON数据传输-重点"><a href="#JSON数据传输-重点" class="headerlink" title="JSON数据传输(重点)"></a>JSON数据传输(重点)</h4><p>现在比较流行的开发方式为<strong>异步调用</strong>。前后台以异步方式进行交换，传输的数据使用的是JSON，所以前端如果发送的是JSON数据，后端该如何接收?</p>
<p>对于JSON数据类型，我们常见的有三种:</p>
<ul>
<li>json普通数组（[“value1”,”value2”,”value3”,…]）</li>
<li>json对象（{key1:value1,key2:value2,…}）</li>
<li>json对象数组（[{key1:value1,…},{key2:value2,…}]）</li>
</ul>
<p>下面我们就来学习以上三种数据类型，前端如何发送，后端如何接收</p>
<h5 id="1-JSON普通数组"><a href="#1-JSON普通数组" class="headerlink" title="1. JSON普通数组"></a>1. JSON普通数组</h5><ul>
<li><p><code>步骤一：</code>导入坐标</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>步骤二：</code>开启SpringMVC<strong>注解支持</strong><br>使用<code>@EnableWebMvc</code>，在SpringMVC的配置类中开启SpringMVC的注解支持，这里面就<strong>包含了将JSON转换成对象</strong>的功能。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.blog.controller&quot;)</span></span><br><span class="line"><span class="comment">//开启json数据类型自动转换</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>步骤三：</code>PostMan发送JSON数据<br><a target="_blank" rel="noopener" href="https://pic.imgdb.cn/item/631addfe16f2c2beb1732627.jpg"><img src="https://pic.imgdb.cn/item/631addfe16f2c2beb1732627.jpg" alt="img"></a></p>
</li>
<li><p><code>步骤四：</code>后台接收参数，参数前添加**@RequestBody**</p>
</li>
<li><p><strong>注意</strong>：此处与接收集合类型的参数不同，需要用@Request<em>Body</em>而不是@Request<em>Param</em></p>
</li>
<li><p>使用<code>@RequestBody</code>注解将外部传递的json数组数据映射到形参的集合对象中作为数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/jsonArrayParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">jsonArrayParam</span><span class="params">(<span class="meta">@RequestBody</span> List&lt;String&gt; hobbies)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;JSON数组参数传递hobbies --&gt; &quot;</span> + hobbies);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;json array param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出如下</p>
<blockquote>
<p>JSON数组参数传递hobbies —&gt; [唱, 跳, Rap, 篮球]</p>
</blockquote>
</li>
</ul>
<p>实际上就是接收List类型的数据。</p>
<h5 id="2-JSON对象"><a href="#2-JSON对象" class="headerlink" title="2. JSON对象"></a>2. JSON对象</h5><ul>
<li><p>请求和数据的发送:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;菲茨罗伊&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="string">&quot;27&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span><span class="string">&quot;萨尔沃&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;province&quot;</span><span class="punctuation">:</span><span class="string">&quot;外域&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>接收请求和参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/jsonPojoParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">jsonPojoParam</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;JSON对象参数传递user --&gt; &quot;</span> + user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;json pojo param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出如下</p>
<blockquote>
<p>JSON对象参数传递user —&gt; User{name&#x3D;’菲茨罗伊’, age&#x3D;27, address&#x3D;Address{province&#x3D;’外域’, city&#x3D;’萨尔沃’}}</p>
</blockquote>
</li>
</ul>
<p>注意：请求的Json为pojo对象时，该类<strong>不能自定义有参构造器</strong>，会导致不能正常解析接收的pojo对象。</p>
<h5 id="3-JSON对象数组"><a href="#3-JSON对象数组" class="headerlink" title="3. JSON对象数组"></a>3. JSON对象数组</h5><ul>
<li><p>发送请求和数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;菲茨罗伊&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="string">&quot;27&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span><span class="string">&quot;萨尔沃&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;province&quot;</span><span class="punctuation">:</span><span class="string">&quot;外域&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;地平线&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span><span class="string">&quot;136&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span><span class="string">&quot;奥林匹斯&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;province&quot;</span><span class="punctuation">:</span><span class="string">&quot;外域&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>接收请求和参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/jsonPojoListParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">jsonPojoListParam</span><span class="params">(<span class="meta">@RequestBody</span> List&lt;User&gt; users)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;JSON对象数组参数传递user --&gt; &quot;</span> + users);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;json pojo list param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>控制台输出如下</p>
<blockquote>
<p>JSON对象数组参数传递user —&gt; [User{name&#x3D;’菲茨罗伊’, age&#x3D;27, address&#x3D;Address{province&#x3D;’外域’, city&#x3D;’萨尔沃’}}, User{name&#x3D;’地平线’, age&#x3D;136, address&#x3D;Address{province&#x3D;’外域’, city&#x3D;’奥林匹斯’}}]</p>
</blockquote>
</li>
</ul>
<p><strong>注意</strong>：此时在处理方法的形参处使用的注解仍然是JSON对象的**@RequestBody<strong>而不是接收集合时使用的</strong>@RequestParam**。</p>
<h5 id="4-小结"><a href="#4-小结" class="headerlink" title="4. 小结"></a>4. 小结</h5><p>SpringMVC接收JSON数据的实现步骤为:</p>
<ol>
<li>导入jackson包</li>
<li><strong>开启SpringMVC注解驱动</strong>，在配置类上添加<code>@EnableWebMvc</code>注解</li>
<li>使用PostMan发送JSON数据</li>
<li>Controller方法的参数前添加<code>@RequestBody</code>注解</li>
</ol>
<p>知识点1：<code>@EnableWebMvc</code></p>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">@EnableWebMvc</th>
</tr>
</thead>
<tbody><tr>
<td align="center">类型</td>
<td align="center">配置类注解</td>
</tr>
<tr>
<td align="center">位置</td>
<td align="center">SpringMVC配置类定义上方</td>
</tr>
<tr>
<td align="center">作用</td>
<td align="center">开启SpringMVC多项辅助功能</td>
</tr>
</tbody></table>
<p>知识点2：<code>@RequestBody</code></p>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">@RequestBody</th>
</tr>
</thead>
<tbody><tr>
<td align="center">类型</td>
<td align="center">形参注解</td>
</tr>
<tr>
<td align="center">位置</td>
<td align="center">SpringMVC控制器方法形参定义前面</td>
</tr>
<tr>
<td align="center">作用</td>
<td align="center">将请求中<strong>请求体所包含的数据传递给请求参数</strong>，此注解一个处理器方法只能使用一次</td>
</tr>
</tbody></table>
<p><code>@RequestBody</code>与<code>@RequestParam</code>区别</p>
<ul>
<li>区别<ul>
<li><code>@RequestParam</code>用于接收url地址传参，表单传参【application&#x2F;x-www-form-urlencoded】</li>
<li><code>@RequestBody</code>用于接收json数据【application&#x2F;json】</li>
</ul>
</li>
<li>应用<ul>
<li>后期开发中，发送json格式数据为主，<code>@RequestBody</code>应用较广</li>
<li>如果发送非json格式数据，选用<code>@RequestParam</code>接收请求参数</li>
</ul>
</li>
</ul>
<h4 id="日期类型参数"><a href="#日期类型参数" class="headerlink" title="日期类型参数"></a>日期类型参数</h4><ul>
<li><p><code>步骤一：</code>编写方法接收日期数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/dateParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">dateParam</span><span class="params">(Date date)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;参数传递date --&gt; &quot;</span> + date);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;date param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>步骤二：</code>启动Tomcat服务器</p>
</li>
<li><p><code>步骤三：</code>使用PostMan发送请求：<code>localhost:8080/user/dateParam?date=2077/12/21</code></p>
</li>
<li><p><code>步骤四：</code>查看控制台，输出如下</p>
<blockquote>
<p>参数传递date —&gt; Tue Dec 21 00:00:00 CST 2077</p>
</blockquote>
</li>
<li><p><code>步骤五：</code>更换日期格式<br>为了能更好的看到程序运行的结果，我们在方法中多添加一个日期参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/dateParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">dateParam</span><span class="params">(Date date1,Date date2)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;参数传递date1 --&gt; &quot;</span> + date1);</span><br><span class="line">    System.out.println(<span class="string">&quot;参数传递date2 --&gt; &quot;</span> + date2);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;date param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>使用PostMan发送请求，如果携带两个不同的日期格式，<code>localhost:8080/user/dateParam?date1=2077/12/21&amp;date2=1997-02-13</code></p>
<p>发送请求和数据后，页面会报400，<code>The request sent by the client was syntactically incorrect.</code></p>
<p>错误的原因是将<code>1997-02-13</code>转换成日期类型的时候失败了，原因是SpringMVC默认支持的字符串转日期的格式为<code>yyyy/MM/dd</code>,而我们现在传递的不符合其默认格式，SpringMVC就无法进行格式转换，所以报错。</p>
<p>解决方案也比较简单，需要使用<code>@DateTimeFormat</code>注解。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/dateParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">dateParam</span><span class="params">(Date date1,<span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> Date date2)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;参数传递date1 --&gt; &quot;</span> + date1);</span><br><span class="line">    System.out.println(<span class="string">&quot;参数传递date2 --&gt; &quot;</span> + date2);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;date param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来我们再来发送一个<strong>携带具体时间的日期</strong>：</p>
<p>如<code>localhost:8080/user/dateParam?date1=2077/12/21&amp;date2=1997-02-13&amp;date3=2022/09/09 16:34:07</code>，那么SpringMVC该怎么处理呢？</p>
<p>继续修改UserController类，添加第三个参数，同时使用<code>@DateTimeFormat</code>来设置日期格式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/dateParam&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">dateParam</span><span class="params">(Date date1,</span></span><br><span class="line"><span class="params">                        <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> Date date2,</span></span><br><span class="line"><span class="params">                        <span class="meta">@DateTimeFormat(pattern =&quot;yyyy/MM/dd HH:mm:ss&quot;)</span> Date date3)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;参数传递date1 --&gt; &quot;</span> + date1);</span><br><span class="line">    System.out.println(<span class="string">&quot;参数传递date2 --&gt; &quot;</span> + date2);</span><br><span class="line">    System.out.println(<span class="string">&quot;参数传递date3 --&gt; &quot;</span> + date3);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;date param&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="内部实现原理"><a href="#内部实现原理" class="headerlink" title="内部实现原理"></a>内部实现原理</h5><p>我们首先先来思考一个问题:</p>
<ul>
<li>前端传递字符串，后端使用日期Date接收</li>
<li>前端传递JSON数据，后端使用对象接收</li>
<li>前端传递字符串，后端使用Integer接收</li>
<li>后台需要的数据类型有很多种</li>
<li>在数据的传递过程中存在很多类型的转换</li>
</ul>
<p><code>问</code>:谁来做这个类型转换?</p>
<ul>
<li><code>答</code>:SpringMVC</li>
</ul>
<p><code>问</code>:SpringMVC是如何实现类型转换的?</p>
<ul>
<li><code>答</code>:SpringMVC中提供了很多类型转换接口和实现类</li>
</ul>
<p>在框架中，有一些类型转换接口，其中有:</p>
<ol>
<li><p><code>Converter</code>接口</p>
<p>注意：Converter所属的包为<code>org.springframework.core.convert.converter</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*    S: the source type</span></span><br><span class="line"><span class="comment">*    T: the target type</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Converter</span>&lt;S, T&gt; &#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="comment">//该方法就是将从页面上接收的数据(S)转换成我们想要的数据类型(T)返回</span></span><br><span class="line">    T <span class="title function_">convert</span><span class="params">(S source)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>到了源码页面我们按CTRL+H可以来看看<code>Converter</code>接口的层次结构</p>
<p>这里给我们提供了很多对应<code>Converter</code>接口的实现类，用来实现不同数据类型之间的转换</p>
<p><img src="https://pic.imgdb.cn/item/631b004216f2c2beb19d8a0a.jpg" alt="img"></p>
</li>
<li><p><code>HttpMessageConverter</code>接口<br>该接口是实现对象与JSON之间的转换工作<br>注意：需要在SpringMVC的配置类把<code>@EnableWebMvc</code>当做标配配置上去，不要省略</p>
</li>
</ol>
<h3 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h3><p>SpringMVC接收到请求和数据后，需要对数据进行处理，当然这个处理可以是转发给Service，Service层再调用Dao层完成的，不管怎样，处理完以后，都需要将结果<strong>返回</strong>给用户。</p>
<p>比如：根据用户ID查询用户信息、查询用户列表、新增用户等。<br>对于响应，主要就包含两部分内容：</p>
<ul>
<li>响应页面</li>
<li>响应数据<ul>
<li>文本数据</li>
<li>json数据</li>
</ul>
</li>
</ul>
<p>因为异步调用是目前常用的主流方式，所以我们需要更关注的就是如何返回JSON数据，对于其他只需要认识了解即可。</p>
<h4 id="响应页面（了解）"><a href="#响应页面（了解）" class="headerlink" title="响应页面（了解）"></a>响应页面（了解）</h4><ul>
<li><p><code>步骤一：</code>设置返回页面</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/toJumpPage&quot;)</span></span><br><span class="line">    <span class="comment">//注意</span></span><br><span class="line">    <span class="comment">//1.此处不能添加@ResponseBody,如果加了该注入，会直接将page.jsp当字符串返回前端</span></span><br><span class="line">    <span class="comment">//2.方法需要返回String</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toJumpPage</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;跳转页面&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;page.jsp&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>步骤二：</code>启动程序测试<br>打开浏览器，访问<code>http://localhost:8080/toJumpPage</code><br>将跳转到<code>page.jsp</code>页面，并展示<code>page.jsp</code>页面的内容</p>
</li>
</ul>
<h4 id="返回文本数据（了解）"><a href="#返回文本数据（了解）" class="headerlink" title="返回文本数据（了解）"></a>返回文本数据（了解）</h4><ul>
<li><p><code>步骤一：</code>设置返回文本内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;toText&quot;)</span></span><br><span class="line"><span class="comment">//此时就需要添加@ResponseBody，将`response text`当成字符串返回给前端</span></span><br><span class="line"><span class="comment">//如果不写@ResponseBody，则会将response text当成页面名去寻找，找不到报404</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toText</span><span class="params">()</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;返回纯文本数据&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;response text&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>步骤二：</code>启动程序测试<br>浏览器访问<code>http://localhost:8080/toText</code><br>页面上出现<code>response text</code>文本数据</p>
</li>
</ul>
<h4 id="响应JSON数据"><a href="#响应JSON数据" class="headerlink" title="响应JSON数据"></a>响应JSON数据</h4><ul>
<li><p>响应POJO对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;toJsonPojo&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">toJsonPojo</span><span class="params">()</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;返回json对象数据&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setName(<span class="string">&quot;Helsing&quot;</span>);</span><br><span class="line">    user.setAge(<span class="number">9527</span>);</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回值为实体类对象，设置返回值为实体类类型，即可实现返回对应对象的json数据，需要依赖@ResponseBody注解和@EnableWebMvc注解</p>
</li>
<li><p>访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/toJsonPojo</span><br></pre></td></tr></table></figure>

<p>页面上成功出现JSON类型数据</p>
<blockquote>
<p>{“name”:”Helsing”,”age”:9527,”address”:null}</p>
</blockquote>
</li>
</ul>
<p>此类中<strong>没有直接写如何转为JSON对象</strong>，但返回了JSON数据，是因为<code>HttpMessageConverter</code>接口帮我们实现了对象与JSON之间的转换工作，我们只需要在<code>SpringMvcConfig</code>配置类上加上<code>@EnableWebMvc</code>注解即可。</p>
<p>SpringMVC太厉害了！</p>
<ul>
<li><p>响应POJO集合对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;toJsonList&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> List&lt;User&gt; <span class="title function_">toJsonList</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;User&gt; users = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;User&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user1.setName(<span class="string">&quot;马文&quot;</span>);</span><br><span class="line">    user1.setAge(<span class="number">27</span>);</span><br><span class="line">    users.add(user1);</span><br><span class="line"></span><br><span class="line">    <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user2.setName(<span class="string">&quot;马武&quot;</span>);</span><br><span class="line">    user2.setAge(<span class="number">28</span>);</span><br><span class="line">    users.add(user2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> users;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问<code>http://localhost:8080/toJsonList</code>，页面上成功出现JSON集合类型数据</p>
<blockquote>
<p>[{“name”:”马文”,”age”:27,”address”:null},{“name”:”马武”,”age”:28,”address”:null}]</p>
</blockquote>
</li>
</ul>
<p>知识点：**@ResponseBody**</p>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">@ResponseBody</th>
</tr>
</thead>
<tbody><tr>
<td align="center">类型</td>
<td align="center">方法\类注解</td>
</tr>
<tr>
<td align="center">位置</td>
<td align="center">SpringMVC控制器方法定义上方和控制类上</td>
</tr>
<tr>
<td align="center">作用</td>
<td align="center">设置当前控制器返回值作为响应体, 写在类上，该类的所有方法都有该注解功能</td>
</tr>
<tr>
<td align="center">相关属性</td>
<td align="center">pattern：指定日期时间格式字符串</td>
</tr>
</tbody></table>
<p>说明:</p>
<ul>
<li>该注解可以写在类上或者方法上</li>
<li>写在类上就是该类下的所有方法都有<code>@ReponseBody</code>功能</li>
<li>当方法上有@ReponseBody注解后<ul>
<li>方法的返回值为字符串，会将其作为文本内容直接响应给前端</li>
<li>方法的返回值为对象，会将对象转换成JSON响应给前端</li>
</ul>
</li>
</ul>
<p>此处又使用到了类型转换，内部还是通过<code>HttpMessageConverter</code>接口完成的，所以<code>Converter</code>除了前面所说的功能外，它还可以实现:</p>
<ul>
<li>对象转Json数据(POJO -&gt; json)</li>
<li>集合转Json数据(Collection -&gt; json)</li>
</ul>
<h2 id="REST风格请求"><a href="#REST风格请求" class="headerlink" title="REST风格请求"></a>REST风格请求</h2><h3 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h3><p>REST(Representational State Transfer)即表征性状态转移，是一种软件架构风格当我们想表示一个网络资源时，可以使用两种方式：</p>
<ul>
<li>传统风格资源描述形式<ul>
<li><code>http://localhost/user/getById?id=1</code> 查询id为1的用户信息</li>
<li><code>http://localhost/user/saveUser</code> 保存用户信息</li>
</ul>
</li>
<li>REST风格描述形式<ul>
<li><code>http://localhost/user/1</code></li>
<li><code>http://localhost/user</code></li>
</ul>
</li>
</ul>
<p>很明显，传统风格一般是<strong>一个请求url对应一种操作</strong>，这样做不仅麻烦，而且也不安全，通过请求的<code>URL</code>地址，就大致能推测出该<code>URL</code>实现的是什么操作。</p>
<p>反观REST风格的描述，请求地址变简洁了，而且只看请求<code>URL</code>并不很容易能猜出来该<code>UR</code>L的具体功能，明显由更高的<strong>安全性</strong>。</p>
<p>因此REST的优势主要有：</p>
<ol>
<li>隐藏资源的访问行为，无法通过地址得知该资源是何种服务或操作</li>
<li>书写简化url</li>
</ol>
<p>那么问题也随之而来，一个相同的<code>URL</code>地址既可以是增加操作，也可以是修改或者查询，那么我们该如何区分该请求到底是什么操作呢？</p>
<ul>
<li>按照REST风格访问资源时，使用<code>行为动作</code>(即<strong>请求方式</strong>)区分对资源进行了何种操作<ul>
<li><code>http://localhost/users</code> 查询全部用户信息 <code>GET</code>（查询）</li>
<li><code>http://localhost/users/1</code> 查询<strong>指定用户</strong>信息 <code>GET</code>（查询）</li>
<li><code>http://localhost/users</code> 添加用户信息 <code>POST</code>（新增&#x2F;保存）</li>
<li><code>http://localhost/users</code> 修改用户信息 <code>PUT</code>（修改&#x2F;更新）</li>
<li><code>http://localhost/users/1</code> 删除用户信息 <code>DELETE</code>（删除）</li>
</ul>
</li>
</ul>
<p>注意：</p>
<ul>
<li><p>上述行为是约定方式，约定不是规范，约定可以打破，所以成为<code>REST</code>风格，而不是<code>REST</code>规范</p>
<ul>
<li>REST提供了对应的<strong>架构方式</strong>，按照这种架构方式设计项目可以降低开发的复杂性，提高系统的可伸缩性</li>
<li>REST中规定<code>GET</code>&#x2F;<code>POST</code>&#x2F;<code>PUT</code>&#x2F;<code>DELETE</code>针对的是查询&#x2F;新增&#x2F;修改&#x2F;删除，但如果我们非要使用<code>GET</code>请求做删除，这点在程序上运行是可以实现的</li>
<li>但是如果大多数人都遵循这种风格，你不遵循，那你写的代码在别人看来就有点莫名其妙了，所以最好还是遵循REST风格</li>
</ul>
</li>
<li><p>描述模块的名称通常使用复数，也就是加s的格式描述，表示此类的资源，而非单个的资源，例如<code>users</code>、<code>books</code>、<code>accounts</code>..</p>
</li>
<li><p>搞清楚了什么是REST分各个后，后面会经常提到一个概念叫<code>RESTful</code>，那么什么是<code>RESTful</code>呢？</p>
<ul>
<li>根据REST风格对资源进行访问称为<code>RESTful</code></li>
</ul>
<p>在我们后期的开发过程中，大多数都是遵循<code>REST</code>风格来访问我们的后台服务。</p>
</li>
</ul>
<h3 id="入门案例"><a href="#入门案例" class="headerlink" title="入门案例"></a>入门案例</h3><h4 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h4><p>环境与之前的SpringMVC一致，都需要ServletContainsInitConfig和SpringMvc两个配置类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletContainersInitConfig</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationConfigDispatcherServletInitializer</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringMvcConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//乱码处理</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Filter[] getServletFilters() &#123;</span><br><span class="line">        <span class="type">CharacterEncodingFilter</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CharacterEncodingFilter</span>();</span><br><span class="line">        filter.setEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Filter</span>[]&#123;filter&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>SpringMvc配置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.hit.controller&quot;)</span></span><br><span class="line"><span class="comment">//开启JSON数据类型自动转换</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringMvcConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编写Pojo模型类User：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关键来了，编写相应Controller的方式与传统不同.</p>
<p>需求:将之前的增删改查替换成<code>RESTful</code>的开发方式。</p>
<ol>
<li>之前不同的<strong>请求有不同的路径</strong>,现在要将其修改为统一的请求路径<ul>
<li>修改前: 新增：<code>/save</code>，修改: <code>/update</code>，删除 <code>/delete</code>..</li>
<li>修改后: 增删改查：<code>/users</code></li>
</ul>
</li>
<li>根据<code>GET</code>查询、<code>POST</code>新增、<code>PUT</code>修改、<code>DELETE</code>删除<strong>对方法的请求方式</strong>进行限定</li>
<li>发送请求的过程中如何设置请求参数?</li>
</ol>
<h4 id="RESTful风格的Controller"><a href="#RESTful风格的Controller" class="headerlink" title="RESTful风格的Controller"></a>RESTful风格的Controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/users&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user save...&quot;</span> + user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user save&#x27;&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时用<strong>POST请求发送带User对象的json数据</strong>会返回module:user save的JSON数据。</p>
<p>注意：此时Controller中的<strong>处理方法save()的参数</strong>即为<strong>请求时需要发送的参数</strong>。</p>
<p>或者delete：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/delete&quot;, method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user delete...&quot;</span> + user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user delete&#x27;&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是现在的删除方法没有携带所要删除数据的id，所以针对RESTful的开发，如何携带<strong>数据参数</strong>?</p>
<p>答案是修改RequestMapping的value参数，将其与路径匹配：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/users/&#123;id&#125;&quot;,method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user delete ...&quot;</span> + id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user delete&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：此时形参需要加**@PathVariable**注解。</p>
<p>发送<code>DELETE</code>请求访问<code>localhost/users/9421</code>即可。</p>
<h5 id="方法参数与请求参数不同"><a href="#方法参数与请求参数不同" class="headerlink" title="方法参数与请求参数不同"></a>方法参数与请求参数不同</h5><p>此时delete方法的参数形参必须为url最后的参数名即id，若想要这两个参数名不同，需要使用注解参数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/users/&#123;id&#125;&quot;,method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer userId)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user delete ...&quot;</span> + userId);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user delete&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="一次请求多个参数"><a href="#一次请求多个参数" class="headerlink" title="一次请求多个参数"></a>一次请求<strong>多个参数</strong></h5><p>直接在url最后加&#x2F;即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/users/&#123;id&#125;/&#123;name&#125;&quot;,method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer userId,<span class="meta">@PathVariable</span> String name)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user delete ...&quot;</span> + userId + <span class="string">&quot;:&quot;</span> + name);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user delete&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="修改请求PUT"><a href="#修改请求PUT" class="headerlink" title="修改请求PUT"></a>修改请求PUT</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/users&quot;,method = RequestMethod.PUT)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user update ...&quot;</span> + user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user update&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="根据ID查询-重要"><a href="#根据ID查询-重要" class="headerlink" title="根据ID查询(重要)"></a>根据ID查询(重要)</h5><p>将请求路径更改为<code>/users/&#123;id&#125;</code>，并设置当前请求方法为<code>GET</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/users/&#123;id&#125;&quot;,method = RequestMethod.GET)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user getById ...&quot;</span> + id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user getById&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="查询所有"><a href="#查询所有" class="headerlink" title="查询所有"></a>查询所有</h5><p>将请求路径更改为<code>/users</code>，并设置当前请求方法为<code>GET</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/users&quot;,method = RequestMethod.GET)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getAll</span><span class="params">()</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;user getAll ...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user getAll&#x27;&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>RESTful入门案例，我们需要记住的内容如下:</p>
<ol>
<li><p>设定<strong>Http请求方式</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value=&quot;&quot;,method = RequestMethod.POST|GET|PUT|DELETE)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设定请求参数(<strong>路径变量</strong>)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value=&quot;/users/&#123;id&#125;&quot;,method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="meta">@ReponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>知识点：<code>@PathVariable</code></p>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">@PathVariable</th>
</tr>
</thead>
<tbody><tr>
<td align="center">类型</td>
<td align="center">形参注解</td>
</tr>
<tr>
<td align="center">位置</td>
<td align="center">SpringMVC控制器方法形参定义前面</td>
</tr>
<tr>
<td align="center">作用</td>
<td align="center">绑定路径参数与处理器方法形参间的关系，要求路径参数名与形参名一一对应</td>
</tr>
</tbody></table>
<p>关于接收参数，我们学过三个注解<code>@RequestBody</code>、<code>@RequestParam</code>、<code>@PathVariable</code>，这<strong>三个注解之间的区别和应用</strong>分别是什么?</p>
<ul>
<li>区别<ul>
<li><code>@RequestParam</code>用于接收url地址传参或表单传参</li>
<li><code>@RequestBody</code>用于接收JSON数据</li>
<li><code>@PathVariable</code>用于接收路径参数，使用{参数名称}描述路径参数</li>
</ul>
</li>
<li>应用<ul>
<li>后期开发中，发送请求参数超过1个时，以JSON格式为主，<code>@RequestBody</code>应用较广</li>
<li>如果发送非JSON格式数据，选用<code>@RequestParam</code>接收请求参数</li>
<li>采用<code>RESTful</code>进行开发，当参数数量较少时，例如1个，可以采用<code>@PathVariable</code>接收请求路径变量，通常用于传递id值</li>
</ul>
</li>
</ul>
<h3 id="RESTful风格快速开发"><a href="#RESTful风格快速开发" class="headerlink" title="RESTful风格快速开发"></a>RESTful风格快速开发</h3><p>做完了上面的<code>RESTful</code>的开发，发现有大量代码冗余，非常麻烦，主要体现在以下三部分：</p>
<ul>
<li>每个方法的<code>@RequestMapping</code>注解中都定义了访问路径<code>/users</code>，重复性太高。<ul>
<li>解决方案：将<code>@RequestMapping</code>提到类上面，用来<strong>定义所有方法共同的访问路径</strong>。</li>
</ul>
</li>
<li>每个方法的<code>@RequestMapping</code>注解中都要使用method属性定义请求方式，重复性太高。<ul>
<li>解决方案：使用<code>@GetMapping</code>、<code>@PostMapping</code>、<code>@PutMapping</code>、<code>@DeleteMapping</code>代替（<strong>重要</strong>）</li>
</ul>
</li>
<li>每个方法响应json都需要加上<code>@ResponseBody</code>注解，重复性太高。<ul>
<li>解决方案：<ul>
<li>将<code>@ResponseBody</code>提到类上面，让所有的方法都有<code>@ResponseBody</code>的功能</li>
<li>使用<code>@RestController</code>注解替换<code>@Controller</code>与<code>@ResponseBody</code>注解，简化书写</li>
</ul>
</li>
</ul>
</li>
</ul>
<p> 修改后的RESTful风格代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;user save ...&quot;</span> + user);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user save&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/&#123;id&#125;/&#123;name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">delete</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer userId, <span class="meta">@PathVariable</span> String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;user delete ...&quot;</span> + userId + <span class="string">&quot;:&quot;</span> + name);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user delete&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping()</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;user update ...&quot;</span> + user);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user update&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;user getById ...&quot;</span> + id);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user getById&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAll</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;user getAll ...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;&#x27;module&#x27;:&#x27;user getAll&#x27;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2023/03/22/Note-of-SpringBoot-learning/"
      title="SpringBoot学习笔记"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        SpringBoot学习笔记
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2023/02/12/Note-of-Spring-learning/"
      title="Spring学习笔记"
     >

    <p class="title-text">
      
        Spring学习笔记
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>

 
    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2023 Kizureina<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn" onclick="topFunction()">
        <span class="material-symbols-rounded">keyboard_arrow_up</span>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.style.opacity = 1;
        } else {
            btn.style.opacity = 0;
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
